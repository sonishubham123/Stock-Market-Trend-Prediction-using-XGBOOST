# -*- coding: utf-8 -*-
"""Untitled0.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1hHDy2GazQdVs90u6gXOF0G83NgNVuBmQ
"""

#IMPORTING THE ESSENTIAL LIBRARIES
import pandas as pd
import xgboost as xgb
import matplotlib.pyplot as plt

#LOADING THE DATA NIFTY50
data = pd.read_csv('ASIANPAINT.csv')
data

#TO SHOW THE DATA MORE VISUALLY
data['Close'].plot()

train_data = data.iloc[:int(.99*len(data)), :]
test_data = data.iloc[int(.99*len(data)):, :]

features = ['Open', 'Volume']
target = 'Close'

model = xgb.XGBRegressor()
model.fit(train_data[features], train_data[target])

predictions = model.predict(test_data[features])
print('Model Predictions:')
print(predictions)

print('Actual Values:')
print(test_data[target])

accuracy = model.score(test_data[features], test_data[target])
print('Accuracy:')
print(accuracy)

plt.plot(data['Close'], label = 'Close Price')
plt.plot(test_data[target].index, predictions, label = 'Predictions')
plt.legend()
plt.show()